#!/bin/sh

# Cleanly remove and destroy epairs before shutdown 

# Script variables
JAIL="$1"
TAPS=$(jexec -l -U root $JAIL ifconfig -g tap)
EPAIRS=$(jexec -l -U root $JAIL ifconfig -g epair)

# Remove all taps from jail
for _tap in $TAPS; do
	ifconfig $_tap -vnet $JAIL
	ifconfig $_tap down 
done

# Remove all epairs from jail 
for _epair in $EPAIRS ; do
	ifconfig $_epair -vnet $JAIL
	ifconfig $_epair destroy
done

